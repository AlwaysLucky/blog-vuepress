---
title: 一些手写题
date: 2023-01-15
tags:
  - 手写系列
summary: 一些手写题
---

## 深拷贝
### 基础版
```js
const obj = {
  name: 'tianzhen',
  getName: function() {
    console.log(this.name)
  },
  friends: ['lisi', 'wangwu']
}
function deepCopy(originObj) {
  if(typeof originObj !== 'object' && !originObj) {
    return
  }
  const target = Array.isArray(originObj) ? [] : {}
  for(let key in originObj) {
    if(Object.hasOwnProperty.call(originObj, key)) {
      target[key] = typeof originObj[key] === 'object' ? deepCopy(originObj[key]) : originObj[key]
    }
  }
  return target
}
```
### 升级版
主要是解决循环引用
```js
const obj = {
  name: 'tianzhen',
  age: undefined,
  getName: function() {
    console.log(this.name)
  },
  friends: ['lisi', 'wangwu']
}
obj.info = obj // 添加循环引用

function deepCopy(originObj, map = new Map()) {
  if(typeof originObj !== 'object' && !originObj) {
    return
  }
  if(map.has(originObj)) {
    return map.get(originObj)
  }
  const target = Array.isArray(originObj) ? [] : {}
  map.set(originObj, target)

  for(let key in originObj) {
    if(Object.hasOwnProperty.call(originObj, key)) {
      target[key] = typeof originObj[key] === 'object' ? deepCopy(originObj[key], map) : originObj[key]
    }
  }
  return target
}
```

## 柯里化
* 只传给函数一部分参数来调用它，返回一个函数再处理剩余参数
* 这个过程就称为柯里化
```js
function add(x, y, z) {
  return x + y +z
}
add(1, 2, 3)
add(1)(2)(3) // 实现类似这种调用

function currying(fn) {
  function curried(...args) {
    if(args.length >= fn.length) {
      return fn.apply(this, args)
    } else {
      // 参数不足时需要返回一个函数
      return function(...args2) {
       return curried.apply(this, [...args, ...args2])
      }
    }
  }
  return curried
}

// 实现2
function currying(fn, ...args) {
  return fn.length <= args.length ? fn.apply(this, args) : currying.bind(this, fn, ...args)
}
```

## 数组拍平
```js
let arr = [1, [2, [3, 4, 5]]];
function flatten(arr) {
  let result = []
  arr.forEach(item => {
    if(Array.isArray(item)) {
      result = result.concat(flatten(item)) // 递归
    } else {
      result.push(item)
    }
  })
  return result
}
```